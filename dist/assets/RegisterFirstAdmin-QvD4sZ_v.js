import{e as _,b as M,u as R,r,j as e,d as u,C as T,f as q}from"./index-Cx_oq0n8.js";import{A as h,L as j}from"./AdminAuthLayout-CvrHMp4s.js";import{C as w}from"./circle-alert-BnMkY9MU.js";import{C as N}from"./circle-check-big-CjVXbCXH.js";import{U as D}from"./user-D_GMPZIW.js";import{E as v,a as y}from"./eye-DUdhcmSP.js";const U="http://localhost:5000",H=()=>{const{registerFirstAdmin:A}=_(),c=M(),{isDarkMode:s}=R(),[t,b]=r.useState({email:"",password:"",confirmPassword:"",full_name:""}),[f,l]=r.useState(""),[a,p]=r.useState(""),[n,g]=r.useState(!1),[m,C]=r.useState(!1),[x,$]=r.useState(!1),[k,P]=r.useState(!0),[S,F]=r.useState(!1);r.useEffect(()=>{(async()=>{try{const o=await fetch(`${U}/api/auth/admin/exists`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include"});o.ok&&(await o.json()).exists&&(F(!0),setTimeout(()=>{c("/admin/login")},2e3))}catch(o){console.error("Failed to check admin status:",o)}finally{P(!1)}})()},[c]);const d=i=>{b({...t,[i.target.name]:i.target.value}),l("")},E=()=>!t.email||!t.password||!t.confirmPassword||!t.full_name?(l("All fields are required"),!1):t.email.includes("@")?t.password.length<8?(l("Password must be at least 8 characters long"),!1):t.password!==t.confirmPassword?(l("Passwords do not match"),!1):!0:(l("Please enter a valid email address"),!1),L=async i=>{if(i.preventDefault(),l(""),p(""),!!E()){g(!0);try{await A(t.email.trim(),t.password,t.full_name.trim()),p("Admin account created successfully! Redirecting to dashboard..."),b({email:"",password:"",confirmPassword:"",full_name:""}),setTimeout(()=>{c("/admin/dashboard")},2e3)}catch(o){l(o.message||"An error occurred during registration")}finally{g(!1)}}};return k?e.jsx(h,{children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(u,{className:"h-10 w-10 text-gold-500 animate-spin mb-4"}),e.jsx("p",{className:`font-serif ${s?"text-stone-300":"text-stone-600"}`,children:"Checking admin status..."})]})}):S?e.jsx(h,{children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs("div",{className:`rounded-2xl shadow-xl p-8 text-center ${s?"bg-stone-900":"bg-white"}`,children:[e.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6 ${s?"bg-blue-900/50 text-blue-400":"bg-blue-100 text-blue-600"}`,children:e.jsx(w,{className:"h-8 w-8"})}),e.jsx("h2",{className:`text-2xl font-bold mb-4 ${s?"text-white":"text-stone-900"}`,children:"Admin Already Exists"}),e.jsx("p",{className:`mb-6 ${s?"text-stone-400":"text-stone-600"}`,children:"An admin account has already been registered. Redirecting to login page..."}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(u,{className:"h-6 w-6 text-gold-500 animate-spin"})}),e.jsx("div",{className:"mt-6",children:e.jsx("a",{href:"/#/admin/login",className:"text-gold-600 hover:text-gold-700 font-medium",children:"Click here if not redirected"})})]})})}):e.jsx(h,{children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs("div",{className:`rounded-2xl shadow-xl overflow-hidden ${s?"bg-stone-900":"bg-white"}`,children:[e.jsxs("div",{className:"bg-gradient-to-r from-gold-600 to-gold-500 px-8 py-10 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center bg-white text-gold-600 p-4 rounded-2xl mb-4 shadow-lg",children:e.jsx(T,{className:"h-8 w-8"})}),e.jsx("h1",{className:"text-3xl font-bold text-white font-serif mb-2",children:"Create First Admin"}),e.jsx("p",{className:"text-gold-100",children:"Set up your Lenny Media admin account"})]}),e.jsxs("form",{onSubmit:L,className:"px-8 py-10",children:[f&&e.jsxs("div",{className:`mb-6 rounded-lg p-4 flex items-start gap-3 ${s?"bg-red-900/20 border border-red-800/50":"bg-red-50 border border-red-200"}`,children:[e.jsx(w,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium ${s?"text-red-300":"text-red-800"}`,children:"Error"}),e.jsx("p",{className:`text-sm ${s?"text-red-400":"text-red-600"}`,children:f})]})]}),a&&e.jsxs("div",{className:`mb-6 rounded-lg p-4 flex items-start gap-3 ${s?"bg-green-900/20 border border-green-800/50":"bg-green-50 border border-green-200"}`,children:[e.jsx(N,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium ${s?"text-green-300":"text-green-800"}`,children:"Success!"}),e.jsx("p",{className:`text-sm ${s?"text-green-400":"text-green-600"}`,children:a})]})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"full_name",className:`block text-sm font-semibold mb-2 ${s?"text-stone-300":"text-stone-700"}`,children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(D,{className:"h-5 w-5 text-stone-400"})}),e.jsx("input",{id:"full_name",name:"full_name",type:"text",value:t.full_name,onChange:d,className:`block w-full pl-12 pr-4 py-3 rounded-lg focus:ring-2 focus:ring-gold-500 focus:border-transparent transition-all ${s?"bg-stone-800 border-stone-700 text-white placeholder-stone-500":"border border-stone-300 text-stone-900"}`,placeholder:"John Doe",disabled:n||!!a,required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:`block text-sm font-semibold mb-2 ${s?"text-stone-300":"text-stone-700"}`,children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(q,{className:"h-5 w-5 text-stone-400"})}),e.jsx("input",{id:"email",name:"email",type:"email",value:t.email,onChange:d,className:`block w-full pl-12 pr-4 py-3 rounded-lg focus:ring-2 focus:ring-gold-500 focus:border-transparent transition-all ${s?"bg-stone-800 border-stone-700 text-white placeholder-stone-500":"border border-stone-300 text-stone-900"}`,placeholder:"admin@lennymedia.co.ke",disabled:n||!!a,required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:`block text-sm font-semibold mb-2 ${s?"text-stone-300":"text-stone-700"}`,children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(j,{className:"h-5 w-5 text-stone-400"})}),e.jsx("input",{id:"password",name:"password",type:m?"text":"password",value:t.password,onChange:d,className:`block w-full pl-12 pr-12 py-3 rounded-lg focus:ring-2 focus:ring-gold-500 focus:border-transparent transition-all ${s?"bg-stone-800 border-stone-700 text-white placeholder-stone-500":"border border-stone-300 text-stone-900"}`,placeholder:"Min. 8 characters",disabled:n||!!a,required:!0,minLength:8}),e.jsx("button",{type:"button",onClick:()=>C(!m),className:"absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-auto",disabled:n||!!a,children:m?e.jsx(v,{className:"h-5 w-5 text-stone-400 hover:text-stone-600"}):e.jsx(y,{className:"h-5 w-5 text-stone-400 hover:text-stone-600"})})]}),e.jsx("p",{className:"mt-1 text-xs text-stone-500",children:"Must be at least 8 characters long"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:`block text-sm font-semibold mb-2 ${s?"text-stone-300":"text-stone-700"}`,children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(j,{className:"h-5 w-5 text-stone-400"})}),e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:x?"text":"password",value:t.confirmPassword,onChange:d,className:`block w-full pl-12 pr-12 py-3 rounded-lg focus:ring-2 focus:ring-gold-500 focus:border-transparent transition-all ${s?"bg-stone-800 border-stone-700 text-white placeholder-stone-500":"border border-stone-300 text-stone-900"}`,placeholder:"Re-enter password",disabled:n||!!a,required:!0,minLength:8}),e.jsx("button",{type:"button",onClick:()=>$(!x),className:"absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-auto",disabled:n||!!a,children:x?e.jsx(v,{className:"h-5 w-5 text-stone-400 hover:text-stone-600"}):e.jsx(y,{className:"h-5 w-5 text-stone-400 hover:text-stone-600"})})]})]}),e.jsx("button",{type:"submit",disabled:n||!!a,className:"w-full bg-gold-500 text-stone-900 py-4 rounded-lg font-bold tracking-wide shadow-lg hover:bg-gold-400 disabled:bg-stone-300 disabled:cursor-not-allowed transition-all duration-300 flex items-center justify-center gap-2 mt-6",children:n?e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"h-5 w-5 animate-spin"}),"Creating Admin Account..."]}):a?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"h-5 w-5"}),"Account Created!"]}):"Create Admin Account"})]}),e.jsx("div",{className:`mt-8 pt-6 ${s?"border-stone-800":"border-stone-200"} border-t`,children:e.jsxs("div",{className:`rounded-lg p-4 ${s?"bg-blue-900/20 border border-blue-800/50":"bg-blue-50 border border-blue-200"}`,children:[e.jsx("p",{className:`text-sm font-medium mb-2 ${s?"text-blue-300":"text-blue-800"}`,children:"First-time setup"}),e.jsx("p",{className:`text-xs ${s?"text-blue-400":"text-blue-600"}`,children:"This will create the first admin account for your Lenny Media platform. You'll be able to create additional admin and staff accounts after logging in."})]})})]})]})})})};export{H as default};
